pipeline {
    agent any

    environment {
        EC2_IP = '3.88.90.213'  // Substitua pelo IP público da sua instância EC2
        SSH_KEY_PATH = 'C:/Users/USER/Downloads/chave_jenkins'  // Caminho da sua chave privada SSH
    }

    stages {
        stage('Test SSH Connection') {
            steps {
                script {
                    // Teste a conexão SSH com a EC2
                    echo "Iniciando a conexão SSH com a EC2..."
                    bat """
                    powershell -Command "ssh -i '${SSH_KEY_PATH}' ec2-user@${EC2_IP} 'echo Conexão SSH bem-sucedida!'"
                    """
                }
            }
        }
    }

    post {
        success {
            echo "Conexão SSH bem-sucedida com a EC2!"
        }
        failure {
            echo "Falha na conexão SSH com a EC2!"
        }
    }
}
